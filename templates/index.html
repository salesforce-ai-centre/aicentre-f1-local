<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 Real-time Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <!-- Add gauge.js library -->
    <script src="/static/js/gauge.min.js"></script>
    <!-- Add Chart.js for performance charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Add a manual speech synthesis check -->
    <script>
        // Try to unblock speech synthesis as early as possible
        document.addEventListener('DOMContentLoaded', function() {
            if (window.speechSynthesis) {
                console.log("SpeechSynthesis API available");
                // Try to get voices early
                const voices = window.speechSynthesis.getVoices();
                console.log(`Initial voices available: ${voices.length}`);
                
                // Force speech synthesis to initialize
                const testUtterance = new SpeechSynthesisUtterance('');
                testUtterance.volume = 0; // Silenced
                window.speechSynthesis.speak(testUtterance);
            } else {
                console.error("SpeechSynthesis API not available in this browser");
            }
        });
    </script>
</head>
<body>
    <div class="top-bar">
        <div class="logo">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/f9/Salesforce.com_logo.svg" alt="Salesforce Logo" class="sf-logo">
        </div>
        <h1>F1 Live Telemetry</h1>
    </div>
    
    <div class="grid-container">
        <!-- Session Info -->
        <div class="card session-info" id="session-card">
            <h2>Session</h2>
            <div class="driver-section">
                <div class="driver-name" id="driverName">DRIVER'S NAME</div>
                <div class="position-badge" id="position">--</div>
            </div>
            <div class="track-name-container">
                <span class="track-label">Track:</span>
                <span class="track-value" id="trackName">---</span>
            </div>
            <div class="session-grid">
                <div class="session-item">
                    <div class="metric-label">Lap</div>
                    <div class="metric-value" id="lapNumber">--</div>
                </div>
                <div class="session-item">
                    <div class="metric-label">Sector</div>
                    <div class="metric-value" id="sector">--</div>
                </div>
                <div class="session-item">
                    <div class="metric-label">Status</div>
                    <div class="metric-value status-pill" id="lapValid">---</div>
                </div>
            </div>
            <div class="time-section">
                <div class="time-item">
                    <div class="time-label">Current Lap</div>
                    <div class="time-value" id="lapTimeSoFar">--:--.---</div>
                    <div class="delta-timing" id="deltaTime">+0.000</div>
                </div>
                <div class="time-item">
                    <div class="time-label">Last Lap</div>
                    <div class="time-value" id="lastLapTime">--:--.---</div>
                    <div class="personal-best" id="personalBest">PB: --:--.---</div>
                </div>
                <div class="sector-timing">
                    <div class="sector-times">
                        <div class="sector-time" id="sector1">
                            <span class="sector-label">S1</span>
                            <span class="sector-value" id="sector1Time">--.-</span>
                        </div>
                        <div class="sector-time" id="sector2">
                            <span class="sector-label">S2</span>
                            <span class="sector-value" id="sector2Time">--.-</span>
                        </div>
                        <div class="sector-time" id="sector3">
                            <span class="sector-label">S3</span>
                            <span class="sector-value" id="sector3Time">--.-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Core Gauges -->
        <div class="card gauges" id="gauges-card">
            <h2>Vitals</h2>
            <div class="gauges-flex-container">
                <div class="gauges-column">
                    <div class="gauge-container large">
                        <canvas id="speedGauge" class="gauge"></canvas>
                        <div class="gauge-label">SPEED (KM/H)</div>
                        <div class="gauge-value"><span id="speedValue">0</span></div>
                    </div>
                </div>
                <div class="gauges-column">
                    <div class="gauge-container large">
                        <canvas id="rpmGauge" class="gauge"></canvas>
                        <div class="gauge-label">RPM</div>
                        <div class="gauge-value"><span id="rpmValue">0</span></div>
                    </div>
                </div>
            </div>
            <div class="gear-display">
                <span id="gear">1</span>
            </div>
        </div>

        <!-- Input Bars -->
        <div class="card inputs" id="inputs-card">
            <h2>Inputs</h2>
            <div class="inputs-container">
                <div class="input-group">
                    <div class="input-label-container">
                        <label for="throttleBar">Throttle</label>
                        <span id="throttleValue" class="input-value">0%</span>
                    </div>
                    <div class="bar-container large">
                        <progress id="throttleBar" max="1" value="0"></progress>
                    </div>
                </div>
                
                <div class="input-group">
                    <div class="input-label-container">
                        <label for="brakeBar">Brake</label>
                        <span id="brakeValue" class="input-value">0%</span>
                    </div>
                    <div class="bar-container large">
                        <progress id="brakeBar" max="1" value="0"></progress>
                    </div>
                </div>
                
                <div class="steering-container">
                    <div class="steering-label">Steering</div>
                    <div class="steering-wheel">
                        <div class="steering-indicator" id="steeringIndicator"></div>
                    </div>
                    <div class="steering-value"><span id="steeringValue">0%</span></div>
                </div>
            </div>
        </div>

        <!-- Advanced Analytics -->
        <div class="card analytics" id="analytics-card">
            <h2>Advanced Analytics</h2>
            <div class="analytics-grid">
                <div class="g-force-container">
                    <div class="g-force-title">G-Forces</div>
                    <div class="g-force-display">
                        <div class="g-lateral">
                            <span class="g-label">Lateral</span>
                            <span class="g-value" id="gForceLateral">0.0G</span>
                        </div>
                        <div class="g-longitudinal">
                            <span class="g-label">Longitudinal</span>
                            <span class="g-value" id="gForceLongitudinal">0.0G</span>
                        </div>
                    </div>
                </div>
                <div class="input-overlay-container">
                    <div class="overlay-title">Input Overlay</div>
                    <div class="input-overlay-chart" id="inputOverlayChart"></div>
                </div>
                <div class="fuel-strategy-container">
                    <div class="strategy-title">Fuel Strategy</div>
                    <div class="fuel-info">
                        <div class="fuel-item">
                            <span class="fuel-label">Consumption</span>
                            <span class="fuel-value" id="fuelConsumption">2.1 kg/lap</span>
                        </div>
                        <div class="fuel-item">
                            <span class="fuel-label">Pit Window</span>
                            <span class="fuel-value" id="pitWindow">Lap 15-18</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Race Coach -->
        <div class="card ai-coach" id="ai-coach-card">
            <h2>AI Race Coach</h2>
            <div class="ai-coach-content">
                <div class="ai-coach-messages" id="ai-coach-messages">
                    <!-- AI coach messages will be added dynamically -->
                </div>
                <div class="strategy-panel">
                    <div class="strategy-alerts" id="strategyAlerts">
                        <div class="alert-item" id="tireAlert" style="display: none;">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <span class="alert-text">Consider pit stop - tire degradation high</span>
                        </div>
                        <div class="alert-item" id="fuelAlert" style="display: none;">
                            <span class="alert-icon">‚õΩ</span>
                            <span class="alert-text">Fuel saving mode recommended</span>
                        </div>
                        <div class="alert-item" id="weatherAlert" style="display: none;">
                            <span class="alert-icon">üåßÔ∏è</span>
                            <span class="alert-text">Rain expected - consider intermediate tires</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tyres & Temps -->
        <div class="card tyres" id="tyres-card">
            <h2>Tyres & Temps</h2>
            <div class="compound-container">
                <span class="tyre-compound-label">Compound:</span>
                <span id="tyreCompound" class="compound-badge">SOFT</span>
            </div>
            <div class="car-tyres-container">
                <div class="car-outline-tyres">
                    <div class="tyre-visual-grid">
                        <div class="tyre-visual fl">
                            <div class="tyre-circle">
                                <div class="tyre-inner">
                                    <div class="tyre-label">FL</div>
                                    <div class="tyre-metrics">
                                        <div class="tyre-wear">Wear: <span id="tyreWearFL">0</span>%</div>
                                        <div class="tyre-temp">Temp: <span id="brakeTempFL">80</span>¬∞C</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tyre-visual fr">
                            <div class="tyre-circle">
                                <div class="tyre-inner">
                                    <div class="tyre-label">FR</div>
                                    <div class="tyre-metrics">
                                        <div class="tyre-wear">Wear: <span id="tyreWearFR">0</span>%</div>
                                        <div class="tyre-temp">Temp: <span id="brakeTempFR">80</span>¬∞C</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tyre-visual rl">
                            <div class="tyre-circle">
                                <div class="tyre-inner">
                                    <div class="tyre-label">RL</div>
                                    <div class="tyre-metrics">
                                        <div class="tyre-wear">Wear: <span id="tyreWearRL">0</span>%</div>
                                        <div class="tyre-temp">Temp: <span id="brakeTempRL">80</span>¬∞C</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tyre-visual rr">
                            <div class="tyre-circle">
                                <div class="tyre-inner">
                                    <div class="tyre-label">RR</div>
                                    <div class="tyre-metrics">
                                        <div class="tyre-wear">Wear: <span id="tyreWearRR">0</span>%</div>
                                        <div class="tyre-temp">Temp: <span id="brakeTempRR">80</span>¬∞C</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="car-shape"></div>
                </div>
            </div>
        </div>

        <!-- ERS & DRS -->
        <div class="card ers-drs" id="ers-drs-card">
            <h2>ERS & DRS</h2>
            <div class="ers-drs-container">
                <div class="drs-section">
                    <div class="drs-indicator-container">
                        <div class="drs-label">DRS</div>
                        <div class="drs-indicator">
                            <span id="drsStatus" class="status-off">INACTIVE</span>
                        </div>
                    </div>
                </div>
                
                <div class="ers-section">
                    <div class="ers-meter-container">
                        <div class="ers-header">
                            <div class="ers-title">ERS ENERGY</div>
                            <div class="ers-value"><span id="ersStoreValue">0</span>%</div>
                        </div>
                        <div class="ers-meter">
                            <progress id="ersStoreBar" max="4000000" value="0" class="ers-progress"></progress>
                        </div>
                    </div>
                    
                    <div class="deploy-mode-container">
                        <div class="deploy-label">DEPLOY MODE</div>
                        <div class="deploy-value">
                            <span id="ersDeployMode" class="deploy-mode">NONE</span>
                        </div>
                    </div>
                    
                    <div class="ers-modes">
                        <div class="mode-item" data-mode="None">None</div>
                        <div class="mode-item" data-mode="Medium">Medium</div>
                        <div class="mode-item" data-mode="Hotlap">Hotlap</div>
                        <div class="mode-item" data-mode="Overtake">Overtake</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Damage Report -->
        <div class="card damage" id="damage-card">
            <h2>Damage</h2>
            <div class="damage-grid">
                <div class="damage-item">
                    <span class="damage-label">Front Left Wing</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarWingFL" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageWingFL">0%</span>
                </div>
                <div class="damage-item">
                    <span class="damage-label">Front Right Wing</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarWingFR" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageWingFR">0%</span>
                </div>
                <div class="damage-item">
                    <span class="damage-label">Rear Wing</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarWingR" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageWingR">0%</span>
                </div>
                <div class="damage-item">
                    <span class="damage-label">Floor</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarFloor" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageFloor">0%</span>
                </div>
                <div class="damage-item">
                    <span class="damage-label">Gearbox</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarGearbox" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageGearbox">0%</span>
                </div>
                <div class="damage-item">
                    <span class="damage-label">Engine</span>
                    <div class="damage-bar-container">
                        <div class="damage-bar" id="damageBarEngine" style="width: 0%"></div>
                    </div>
                    <span class="damage-value" id="damageEngine">0%</span>
                </div>
            </div>
        </div>

        <!-- Lap Time Chart -->
        <div class="card lap-chart" id="lap-chart-card">
            <h2>Lap Times</h2>
            <div class="chart-container">
                <canvas id="lapTimeChart"></canvas>
            </div>
        </div>

        <!-- Sector Performance -->
        <div class="card sector-perf" id="sector-perf-card">
            <h2>Sector Performance</h2>
            <div class="chart-container">
                <canvas id="sectorChart"></canvas>
            </div>
        </div>

        <!-- Speed Trace -->
        <div class="card speed-trace" id="speed-trace-card">
            <h2>Speed Trace</h2>
            <div class="chart-container">
                <canvas id="speedTraceChart"></canvas>
            </div>
        </div>

        <!-- Event Log -->
        <div class="card event-log" id="event-log-card">
            <h2>Events & Alerts</h2>
            <ul id="eventList">
                <li>Waiting for events...</li>
            </ul>
        </div>
    </div>

    <script src="/static/js/script.js"></script>
</body>
</html>